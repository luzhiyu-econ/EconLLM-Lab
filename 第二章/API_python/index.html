<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=经济学LLM实用指南><meta name=author content=陆知雨><link href=https://luzhiyu-econ.github.io/EconLLM-Lab/%E7%AC%AC%E4%BA%8C%E7%AB%A0/API_python/ rel=canonical><link href=../API_intro/ rel=prev><link href=../Boost_API/ rel=next><link rel=icon href=../../figures/logo.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.2"><title>第一次调用API - EconLLM-Lab</title><link rel=stylesheet href=../../assets/stylesheets/main.50c56a3b.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto Slab";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#api class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../.. title=EconLLM-Lab class="md-header__button md-logo" aria-label=EconLLM-Lab data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EconLLM-Lab </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 第一次调用API </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54 0 4.5-2.94 8.27-7 9.54.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__source> <a href=https://github.com/luzhiyu-econ/EconLLM-Lab title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> EconLLM-Lab </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=EconLLM-Lab class="md-nav__button md-logo" aria-label=EconLLM-Lab data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> EconLLM-Lab </label> <div class=md-nav__source> <a href=https://github.com/luzhiyu-econ/EconLLM-Lab title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> EconLLM-Lab </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> 序言 </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> 前置知识 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 前置知识 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%80%E7%AB%A0/quickstart/ class=md-nav__link> <span class=md-ellipsis> 计算机上手配置 </span> </a> </li> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%80%E7%AB%A0/pythonenv/ class=md-nav__link> <span class=md-ellipsis> Python环境配置 </span> </a> </li> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%80%E7%AB%A0/command-line-tools/ class=md-nav__link> <span class=md-ellipsis> 学会使用命令行 </span> </a> </li> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%80%E7%AB%A0/github%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/ class=md-nav__link> <span class=md-ellipsis> 学会使用Git </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> API调用 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> API调用 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../API_intro/ class=md-nav__link> <span class=md-ellipsis> API概述 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 第一次调用API </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 第一次调用API </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1 class=md-nav__link> <span class=md-ellipsis> 1. 环境准备与依赖安装 </span> </a> <nav class=md-nav aria-label="1. 环境准备与依赖安装"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-python class=md-nav__link> <span class=md-ellipsis> 1.1 Python环境要求 </span> </a> </li> <li class=md-nav__item> <a href=#12 class=md-nav__link> <span class=md-ellipsis> 1.2 必要库安装 </span> </a> </li> <li class=md-nav__item> <a href=#13-api class=md-nav__link> <span class=md-ellipsis> 1.3 API密钥管理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-api class=md-nav__link> <span class=md-ellipsis> 2. 第一个API调用示例 </span> </a> <nav class=md-nav aria-label="2. 第一个API调用示例"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-openai-api class=md-nav__link> <span class=md-ellipsis> 2.1 OpenAI API基础调用 </span> </a> </li> <li class=md-nav__item> <a href=#22 class=md-nav__link> <span class=md-ellipsis> 2.2 参数详解 </span> </a> </li> <li class=md-nav__item> <a href=#23 class=md-nav__link> <span class=md-ellipsis> 2.3 错误处理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-llm class=md-nav__link> <span class=md-ellipsis> 3. 国内LLM平台接入 </span> </a> <nav class=md-nav aria-label="3. 国内LLM平台接入"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31-api class=md-nav__link> <span class=md-ellipsis> 3.1 百度文心一言API </span> </a> </li> <li class=md-nav__item> <a href=#32-aichatglm class=md-nav__link> <span class=md-ellipsis> 3.2 智谱AI（ChatGLM） </span> </a> </li> <li class=md-nav__item> <a href=#33 class=md-nav__link> <span class=md-ellipsis> 3.3 阿里通义千问 </span> </a> </li> <li class=md-nav__item> <a href=#34-deepseek-api class=md-nav__link> <span class=md-ellipsis> 3.4 DeepSeek API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4 class=md-nav__link> <span class=md-ellipsis> 4. 经济学应用场景 </span> </a> <nav class=md-nav aria-label="4. 经济学应用场景"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41 class=md-nav__link> <span class=md-ellipsis> 4.1 文本摘要 </span> </a> </li> <li class=md-nav__item> <a href=#42 class=md-nav__link> <span class=md-ellipsis> 4.2 情感分析 </span> </a> </li> <li class=md-nav__item> <a href=#43 class=md-nav__link> <span class=md-ellipsis> 4.3 分类任务 </span> </a> </li> <li class=md-nav__item> <a href=#44 class=md-nav__link> <span class=md-ellipsis> 4.4 信息提取 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5 class=md-nav__link> <span class=md-ellipsis> 5. 实际案例：政府工作报告分析 </span> </a> <nav class=md-nav aria-label="5. 实际案例：政府工作报告分析"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#51 class=md-nav__link> <span class=md-ellipsis> 5.1 任务目标 </span> </a> </li> <li class=md-nav__item> <a href=#52 class=md-nav__link> <span class=md-ellipsis> 5.2 提示词设计 </span> </a> </li> <li class=md-nav__item> <a href=#53 class=md-nav__link> <span class=md-ellipsis> 5.3 批量处理准备 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6 class=md-nav__link> <span class=md-ellipsis> 6. 响应处理与解析 </span> </a> <nav class=md-nav aria-label="6. 响应处理与解析"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#61-json class=md-nav__link> <span class=md-ellipsis> 6.1 JSON响应解析 </span> </a> </li> <li class=md-nav__item> <a href=#62 class=md-nav__link> <span class=md-ellipsis> 6.2 结果验证 </span> </a> </li> <li class=md-nav__item> <a href=#63 class=md-nav__link> <span class=md-ellipsis> 6.3 结果存储 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7 class=md-nav__link> <span class=md-ellipsis> 7. 成本控制与优化 </span> </a> <nav class=md-nav aria-label="7. 成本控制与优化"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#71-token class=md-nav__link> <span class=md-ellipsis> 7.1 Token使用优化 </span> </a> </li> <li class=md-nav__item> <a href=#72 class=md-nav__link> <span class=md-ellipsis> 7.2 费用监控 </span> </a> </li> <li class=md-nav__item> <a href=#73 class=md-nav__link> <span class=md-ellipsis> 7.3 缓存机制 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8 class=md-nav__link> <span class=md-ellipsis> 8. 调试与测试 </span> </a> <nav class=md-nav aria-label="8. 调试与测试"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#81 class=md-nav__link> <span class=md-ellipsis> 8.1 日志记录 </span> </a> </li> <li class=md-nav__item> <a href=#82 class=md-nav__link> <span class=md-ellipsis> 8.2 单元测试 </span> </a> </li> <li class=md-nav__item> <a href=#83 class=md-nav__link> <span class=md-ellipsis> 8.3 性能监控 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9 class=md-nav__link> <span class=md-ellipsis> 9. 最佳实践总结 </span> </a> <nav class=md-nav aria-label="9. 最佳实践总结"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#91 class=md-nav__link> <span class=md-ellipsis> 9.1 代码组织 </span> </a> </li> <li class=md-nav__item> <a href=#92 class=md-nav__link> <span class=md-ellipsis> 9.2 安全考虑 </span> </a> </li> <li class=md-nav__item> <a href=#93 class=md-nav__link> <span class=md-ellipsis> 9.3 可维护性 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#10 class=md-nav__link> <span class=md-ellipsis> 10. 练习作业 </span> </a> <nav class=md-nav aria-label="10. 练习作业"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#101 class=md-nav__link> <span class=md-ellipsis> 10.1 基础练习 </span> </a> </li> <li class=md-nav__item> <a href=#102 class=md-nav__link> <span class=md-ellipsis> 10.2 进阶练习 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 本章小结 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Boost_API/ class=md-nav__link> <span class=md-ellipsis> 多线程方法加速调用 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> 微调训练 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 微调训练 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%89%E7%AB%A0/dataPreparation/ class=md-nav__link> <span class=md-ellipsis> 数据集准备 </span> </a> </li> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%89%E7%AB%A0/Evaluation/ class=md-nav__link> <span class=md-ellipsis> 模型评估与测试 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> RAG </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> RAG </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E7%AC%AC%E5%9B%9B%E7%AB%A0/RAG/ class=md-nav__link> <span class=md-ellipsis> 如何构建与部署知识库 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> MCP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> MCP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%BA%94%E7%AB%A0/MCP_intro/ class=md-nav__link> <span class=md-ellipsis> MCP基本结构 </span> </a> </li> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%BA%94%E7%AB%A0/MCP_example/ class=md-nav__link> <span class=md-ellipsis> MCP示例 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Multi-agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Multi-agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E7%AC%AC%E5%85%AD%E7%AB%A0/autogen/ class=md-nav__link> <span class=md-ellipsis> autogen </span> </a> </li> <li class=md-nav__item> <a href=../../%E7%AC%AC%E5%85%AD%E7%AB%A0/coze/ class=md-nav__link> <span class=md-ellipsis> coze </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> LLM应用推荐 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> LLM应用推荐 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../%E7%AC%AC%E4%B8%83%E7%AB%A0/LLM_example/ class=md-nav__link> <span class=md-ellipsis> LLM应用推荐 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../%E9%99%84%E5%BD%95/ class=md-nav__link> <span class=md-ellipsis> 附录 </span> </a> </li> <li class=md-nav__item> <a href=../../References/ class=md-nav__link> <span class=md-ellipsis> 参考资料 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1 class=md-nav__link> <span class=md-ellipsis> 1. 环境准备与依赖安装 </span> </a> <nav class=md-nav aria-label="1. 环境准备与依赖安装"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-python class=md-nav__link> <span class=md-ellipsis> 1.1 Python环境要求 </span> </a> </li> <li class=md-nav__item> <a href=#12 class=md-nav__link> <span class=md-ellipsis> 1.2 必要库安装 </span> </a> </li> <li class=md-nav__item> <a href=#13-api class=md-nav__link> <span class=md-ellipsis> 1.3 API密钥管理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-api class=md-nav__link> <span class=md-ellipsis> 2. 第一个API调用示例 </span> </a> <nav class=md-nav aria-label="2. 第一个API调用示例"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-openai-api class=md-nav__link> <span class=md-ellipsis> 2.1 OpenAI API基础调用 </span> </a> </li> <li class=md-nav__item> <a href=#22 class=md-nav__link> <span class=md-ellipsis> 2.2 参数详解 </span> </a> </li> <li class=md-nav__item> <a href=#23 class=md-nav__link> <span class=md-ellipsis> 2.3 错误处理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-llm class=md-nav__link> <span class=md-ellipsis> 3. 国内LLM平台接入 </span> </a> <nav class=md-nav aria-label="3. 国内LLM平台接入"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31-api class=md-nav__link> <span class=md-ellipsis> 3.1 百度文心一言API </span> </a> </li> <li class=md-nav__item> <a href=#32-aichatglm class=md-nav__link> <span class=md-ellipsis> 3.2 智谱AI（ChatGLM） </span> </a> </li> <li class=md-nav__item> <a href=#33 class=md-nav__link> <span class=md-ellipsis> 3.3 阿里通义千问 </span> </a> </li> <li class=md-nav__item> <a href=#34-deepseek-api class=md-nav__link> <span class=md-ellipsis> 3.4 DeepSeek API </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4 class=md-nav__link> <span class=md-ellipsis> 4. 经济学应用场景 </span> </a> <nav class=md-nav aria-label="4. 经济学应用场景"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#41 class=md-nav__link> <span class=md-ellipsis> 4.1 文本摘要 </span> </a> </li> <li class=md-nav__item> <a href=#42 class=md-nav__link> <span class=md-ellipsis> 4.2 情感分析 </span> </a> </li> <li class=md-nav__item> <a href=#43 class=md-nav__link> <span class=md-ellipsis> 4.3 分类任务 </span> </a> </li> <li class=md-nav__item> <a href=#44 class=md-nav__link> <span class=md-ellipsis> 4.4 信息提取 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5 class=md-nav__link> <span class=md-ellipsis> 5. 实际案例：政府工作报告分析 </span> </a> <nav class=md-nav aria-label="5. 实际案例：政府工作报告分析"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#51 class=md-nav__link> <span class=md-ellipsis> 5.1 任务目标 </span> </a> </li> <li class=md-nav__item> <a href=#52 class=md-nav__link> <span class=md-ellipsis> 5.2 提示词设计 </span> </a> </li> <li class=md-nav__item> <a href=#53 class=md-nav__link> <span class=md-ellipsis> 5.3 批量处理准备 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6 class=md-nav__link> <span class=md-ellipsis> 6. 响应处理与解析 </span> </a> <nav class=md-nav aria-label="6. 响应处理与解析"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#61-json class=md-nav__link> <span class=md-ellipsis> 6.1 JSON响应解析 </span> </a> </li> <li class=md-nav__item> <a href=#62 class=md-nav__link> <span class=md-ellipsis> 6.2 结果验证 </span> </a> </li> <li class=md-nav__item> <a href=#63 class=md-nav__link> <span class=md-ellipsis> 6.3 结果存储 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7 class=md-nav__link> <span class=md-ellipsis> 7. 成本控制与优化 </span> </a> <nav class=md-nav aria-label="7. 成本控制与优化"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#71-token class=md-nav__link> <span class=md-ellipsis> 7.1 Token使用优化 </span> </a> </li> <li class=md-nav__item> <a href=#72 class=md-nav__link> <span class=md-ellipsis> 7.2 费用监控 </span> </a> </li> <li class=md-nav__item> <a href=#73 class=md-nav__link> <span class=md-ellipsis> 7.3 缓存机制 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8 class=md-nav__link> <span class=md-ellipsis> 8. 调试与测试 </span> </a> <nav class=md-nav aria-label="8. 调试与测试"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#81 class=md-nav__link> <span class=md-ellipsis> 8.1 日志记录 </span> </a> </li> <li class=md-nav__item> <a href=#82 class=md-nav__link> <span class=md-ellipsis> 8.2 单元测试 </span> </a> </li> <li class=md-nav__item> <a href=#83 class=md-nav__link> <span class=md-ellipsis> 8.3 性能监控 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9 class=md-nav__link> <span class=md-ellipsis> 9. 最佳实践总结 </span> </a> <nav class=md-nav aria-label="9. 最佳实践总结"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#91 class=md-nav__link> <span class=md-ellipsis> 9.1 代码组织 </span> </a> </li> <li class=md-nav__item> <a href=#92 class=md-nav__link> <span class=md-ellipsis> 9.2 安全考虑 </span> </a> </li> <li class=md-nav__item> <a href=#93 class=md-nav__link> <span class=md-ellipsis> 9.3 可维护性 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#10 class=md-nav__link> <span class=md-ellipsis> 10. 练习作业 </span> </a> <nav class=md-nav aria-label="10. 练习作业"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#101 class=md-nav__link> <span class=md-ellipsis> 10.1 基础练习 </span> </a> </li> <li class=md-nav__item> <a href=#102 class=md-nav__link> <span class=md-ellipsis> 10.2 进阶练习 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 本章小结 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=api>第一次调用API<a class=headerlink href=#api title="Permanent link">&para;</a></h1> <p>本章将详细介绍如何使用Python进行LLM API调用，从最基础的单次调用到实际的经济学应用案例，帮助经济学研究者快速上手API编程。</p> <h2 id=1>1. 环境准备与依赖安装<a class=headerlink href=#1 title="Permanent link">&para;</a></h2> <h3 id=11-python>1.1 Python环境要求<a class=headerlink href=#11-python title="Permanent link">&para;</a></h3> <ul> <li>Python 3.8+版本</li> <li>推荐使用虚拟环境管理依赖</li> </ul> <h3 id=12>1.2 必要库安装<a class=headerlink href=#12 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>openai<span class=w> </span>requests<span class=w> </span>pandas<span class=w> </span>python-dotenv
</code></pre></div> <h3 id=13-api>1.3 API密钥管理<a class=headerlink href=#13-api title="Permanent link">&para;</a></h3> <ul> <li>创建<code>.env</code>文件存储API密钥</li> <li>使用环境变量保护敏感信息</li> <li>密钥安全存储最佳实践</li> </ul> <h2 id=2-api>2. 第一个API调用示例<a class=headerlink href=#2-api title="Permanent link">&para;</a></h2> <h3 id=21-openai-api>2.1 OpenAI API基础调用<a class=headerlink href=#21-openai-api title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>openai</span><span class=w> </span><span class=kn>import</span> <span class=n>OpenAI</span>
<span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dotenv</span><span class=w> </span><span class=kn>import</span> <span class=n>load_dotenv</span>

<span class=c1># 加载环境变量</span>
<span class=n>load_dotenv</span><span class=p>()</span>

<span class=c1># 初始化客户端</span>
<span class=n>client</span> <span class=o>=</span> <span class=n>OpenAI</span><span class=p>(</span><span class=n>api_key</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>))</span>

<span class=c1># 基础对话</span>
<span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>chat</span><span class=o>.</span><span class=n>completions</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4&quot;</span><span class=p>,</span>
    <span class=n>messages</span><span class=o>=</span><span class=p>[</span>
        <span class=p>{</span><span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;system&quot;</span><span class=p>,</span> <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;你是一个经济学专家助手&quot;</span><span class=p>},</span>
        <span class=p>{</span><span class=s2>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;user&quot;</span><span class=p>,</span> <span class=s2>&quot;content&quot;</span><span class=p>:</span> <span class=s2>&quot;解释什么是通胀&quot;</span><span class=p>}</span>
    <span class=p>]</span>
<span class=p>)</span>

<span class=nb>print</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>choices</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>message</span><span class=o>.</span><span class=n>content</span><span class=p>)</span>
</code></pre></div> <h3 id=22>2.2 参数详解<a class=headerlink href=#22 title="Permanent link">&para;</a></h3> <ul> <li><code>model</code>: 模型选择策略</li> <li><code>messages</code>: 对话历史结构</li> <li><code>temperature</code>: 创造性控制</li> <li><code>max_tokens</code>: 输出长度限制</li> <li><code>top_p</code>: 核采样参数</li> </ul> <h3 id=23>2.3 错误处理<a class=headerlink href=#23 title="Permanent link">&para;</a></h3> <ul> <li>网络异常处理</li> <li>API限制错误</li> <li>费用控制机制</li> </ul> <h2 id=3-llm>3. 国内LLM平台接入<a class=headerlink href=#3-llm title="Permanent link">&para;</a></h2> <h3 id=31-api>3.1 百度文心一言API<a class=headerlink href=#31-api title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>requests</span>

<span class=k>def</span><span class=w> </span><span class=nf>call_ernie_api</span><span class=p>(</span><span class=n>prompt</span><span class=p>):</span>
    <span class=c1># API调用示例代码</span>
    <span class=k>pass</span>
</code></pre></div> <h3 id=32-aichatglm>3.2 智谱AI（ChatGLM）<a class=headerlink href=#32-aichatglm title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>from</span><span class=w> </span><span class=nn>zhipuai</span><span class=w> </span><span class=kn>import</span> <span class=n>ZhipuAI</span>

<span class=k>def</span><span class=w> </span><span class=nf>call_chatglm_api</span><span class=p>(</span><span class=n>prompt</span><span class=p>):</span>
    <span class=c1># API调用示例代码</span>
    <span class=k>pass</span>
</code></pre></div> <h3 id=33>3.3 阿里通义千问<a class=headerlink href=#33 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>call_qwen_api</span><span class=p>(</span><span class=n>prompt</span><span class=p>):</span>
    <span class=c1># API调用示例代码</span>
    <span class=k>pass</span>
</code></pre></div> <h3 id=34-deepseek-api>3.4 DeepSeek API<a class=headerlink href=#34-deepseek-api title="Permanent link">&para;</a></h3> <p>基于现有notebook示例的详细解释</p> <h2 id=4>4. 经济学应用场景<a class=headerlink href=#4 title="Permanent link">&para;</a></h2> <h3 id=41>4.1 文本摘要<a class=headerlink href=#41 title="Permanent link">&para;</a></h3> <ul> <li>经济政策文件摘要</li> <li>研究论文摘要生成</li> <li>新闻事件提取</li> </ul> <h3 id=42>4.2 情感分析<a class=headerlink href=#42 title="Permanent link">&para;</a></h3> <ul> <li>财经新闻情感判断</li> <li>投资者评论分析</li> <li>政策文本态度分析</li> </ul> <h3 id=43>4.3 分类任务<a class=headerlink href=#43 title="Permanent link">&para;</a></h3> <ul> <li>经济指标分类</li> <li>行业类别识别</li> <li>风险等级评估</li> </ul> <h3 id=44>4.4 信息提取<a class=headerlink href=#44 title="Permanent link">&para;</a></h3> <ul> <li>结构化数据提取</li> <li>关键指标识别</li> <li>实体关系抽取</li> </ul> <h2 id=5>5. 实际案例：政府工作报告分析<a class=headerlink href=#5 title="Permanent link">&para;</a></h2> <h3 id=51>5.1 任务目标<a class=headerlink href=#51 title="Permanent link">&para;</a></h3> <p>从政府工作报告中提取经济增长目标</p> <h3 id=52>5.2 提示词设计<a class=headerlink href=#52 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=n>prompt_template</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<span class=s2>从政府工作报告文本中识别该市当年经济增长目标，并将其以规范的JSON格式输出。</span>

<span class=s2># 输出格式</span>
<span class=s2>{</span>
<span class=s2>  &quot;economic_growth_goal&quot;: &quot;[百分比]&quot;</span>
<span class=s2>}</span>

<span class=s2># 文本内容</span>
<span class=si>{text}</span>
<span class=s2>&quot;&quot;&quot;</span>
</code></pre></div> <h3 id=53>5.3 批量处理准备<a class=headerlink href=#53 title="Permanent link">&para;</a></h3> <ul> <li>数据预处理</li> <li>结果验证机制</li> <li>错误记录与重试</li> </ul> <h2 id=6>6. 响应处理与解析<a class=headerlink href=#6 title="Permanent link">&para;</a></h2> <h3 id=61-json>6.1 JSON响应解析<a class=headerlink href=#61-json title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>json</span>

<span class=k>def</span><span class=w> </span><span class=nf>parse_llm_response</span><span class=p>(</span><span class=n>response_text</span><span class=p>):</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=c1># 清理响应文本</span>
        <span class=n>cleaned</span> <span class=o>=</span> <span class=n>response_text</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;```json&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;```&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
        <span class=n>result</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>cleaned</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>result</span>
    <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;JSON解析错误: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=k>return</span> <span class=kc>None</span>
</code></pre></div> <h3 id=62>6.2 结果验证<a class=headerlink href=#62 title="Permanent link">&para;</a></h3> <ul> <li>输出格式检查</li> <li>数据合理性验证</li> <li>异常值处理</li> </ul> <h3 id=63>6.3 结果存储<a class=headerlink href=#63 title="Permanent link">&para;</a></h3> <ul> <li>CSV格式保存</li> <li>数据库存储</li> <li>中间结果缓存</li> </ul> <h2 id=7>7. 成本控制与优化<a class=headerlink href=#7 title="Permanent link">&para;</a></h2> <h3 id=71-token>7.1 Token使用优化<a class=headerlink href=#71-token title="Permanent link">&para;</a></h3> <ul> <li>提示词长度控制</li> <li>响应长度限制</li> <li>模型选择策略</li> </ul> <h3 id=72>7.2 费用监控<a class=headerlink href=#72 title="Permanent link">&para;</a></h3> <ul> <li>API调用计数</li> <li>成本预算设置</li> <li>使用量报告</li> </ul> <h3 id=73>7.3 缓存机制<a class=headerlink href=#73 title="Permanent link">&para;</a></h3> <ul> <li>重复请求避免</li> <li>结果缓存策略</li> <li>本地存储优化</li> </ul> <h2 id=8>8. 调试与测试<a class=headerlink href=#8 title="Permanent link">&para;</a></h2> <h3 id=81>8.1 日志记录<a class=headerlink href=#81 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>

<span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
<span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>log_api_call</span><span class=p>(</span><span class=n>prompt</span><span class=p>,</span> <span class=n>response</span><span class=p>):</span>
    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;API调用 - Prompt长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>prompt</span><span class=p>)</span><span class=si>}</span><span class=s2>, 响应长度: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>response</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=82>8.2 单元测试<a class=headerlink href=#82 title="Permanent link">&para;</a></h3> <ul> <li>API调用测试</li> <li>响应解析测试</li> <li>边界条件测试</li> </ul> <h3 id=83>8.3 性能监控<a class=headerlink href=#83 title="Permanent link">&para;</a></h3> <ul> <li>响应时间统计</li> <li>成功率监控</li> <li>错误类型分析</li> </ul> <h2 id=9>9. 最佳实践总结<a class=headerlink href=#9 title="Permanent link">&para;</a></h2> <h3 id=91>9.1 代码组织<a class=headerlink href=#91 title="Permanent link">&para;</a></h3> <ul> <li>模块化设计</li> <li>配置文件管理</li> <li>错误处理统一</li> </ul> <h3 id=92>9.2 安全考虑<a class=headerlink href=#92 title="Permanent link">&para;</a></h3> <ul> <li>API密钥保护</li> <li>输入验证</li> <li>输出过滤</li> </ul> <h3 id=93>9.3 可维护性<a class=headerlink href=#93 title="Permanent link">&para;</a></h3> <ul> <li>代码注释</li> <li>文档更新</li> <li>版本管理</li> </ul> <h2 id=10>10. 练习作业<a class=headerlink href=#10 title="Permanent link">&para;</a></h2> <h3 id=101>10.1 基础练习<a class=headerlink href=#101 title="Permanent link">&para;</a></h3> <ol> <li>完成第一个API调用</li> <li>实现简单的文本分类</li> <li>设计经济学相关的提示词</li> </ol> <h3 id=102>10.2 进阶练习<a class=headerlink href=#102 title="Permanent link">&para;</a></h3> <ol> <li>集成多个LLM平台</li> <li>实现结果对比分析</li> <li>构建简单的评估指标</li> </ol> <h2 id=_1>本章小结<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>通过本章学习，你应该能够： 1. 独立完成各主流LLM平台的API调用 2. 设计适合经济学研究的提示词 3. 处理和解析API响应结果 4. 实施基本的成本控制和错误处理</p> <blockquote> <p><strong>下一步</strong>: 学习多线程方法加速API调用，提高数据处理效率</p> </blockquote> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025-present <a href=https://github.com/luzhiyu-econ target=_blank rel="noopener noreferrer">陆知雨</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "navigation.tracking", "navigation.top", "navigation.indexes", "search.highlight", "search.share", "search.suggest", "content.code.annotate", "toc.follow"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../assets/javascripts/bundle.d7c377c4.min.js></script> <script src=../../js/open_in_new_tab.js></script> </body> </html>